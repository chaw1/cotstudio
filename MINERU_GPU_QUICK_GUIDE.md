# MinerU GPU和识别模式配置快速指南

## 功能概述

MinerU引擎现在支持GPU加速开关和识别模式选择，让您根据需求灵活配置OCR处理方式。

## 快速开始

### 方式一：在OCR处理时配置

1. **进入OCR处理**
   - 打开项目 → 上传文件
   - 点击"OCR处理"标签

2. **选择MinerU引擎**
   - 在引擎下拉框中选择"MinerU"

3. **展开高级选项**
   - 点击"显示高级选项"按钮

4. **配置参数**
   - **GPU加速**: 开启/关闭 (有NVIDIA显卡推荐开启)
   - **识别模式**: 
     - ⚡ **快速模式**: 速度快，适合简单文档
     - ✓ **高精度模式**: 精度高，适合复杂文档
   - **批处理大小**: 建议GPU模式使用8-16，CPU模式使用2-4

5. **开始处理**
   - 点击"开始OCR处理"按钮

### 方式二：在系统设置中配置

1. **进入设置**
   - 点击右上角设置图标
   - 选择"OCR引擎配置"

2. **找到MinerU引擎**
   - 滚动到MinerU引擎卡片
   - 点击"编辑"按钮

3. **修改默认配置**
   - 配置GPU开关和识别模式
   - 点击"保存配置"

4. **使用默认配置**
   - 之后OCR处理将自动使用您的默认配置

## 模式选择建议

### 🚀 快速模式 (Pipeline)

**推荐场景**:
- ✅ 批量处理大量文档
- ✅ 文档结构相对简单
- ✅ 对速度要求高
- ✅ 扫描质量较好

**性能**: GPU ~2秒/页, CPU ~6秒/页

### 🎯 高精度模式 (VLM)

**推荐场景**:
- ✅ 学术论文(包含公式)
- ✅ 复杂表格文档
- ✅ 扫描质量较差
- ✅ 对准确率要求极高

**性能**: GPU ~6秒/页, CPU ~30秒/页

## GPU配置建议

### 有NVIDIA显卡用户

**推荐配置**:
```
GPU加速: 开启
识别模式: 快速模式 (或根据文档复杂度选择)
批处理大小: 8-16
```

**优势**:
- ⚡ 处理速度提升3-5倍
- 🚀 可以处理更大批次
- 💪 支持高精度模式

### 无显卡用户

**推荐配置**:
```
GPU加速: 关闭
识别模式: 快速模式
批处理大小: 2-4
```

**建议**:
- 📄 处理少量文档
- 🕐 避开系统繁忙时段
- 📊 简单文档优先使用快速模式

## 配置示例

### 示例1: 批量处理简单PDF

**场景**: 100个扫描清晰的合同文档

**配置**:
- GPU: 开启 ✅
- 模式: 快速模式 ⚡
- 批处理: 16
- 预估时间: ~30分钟

### 示例2: 处理学术论文

**场景**: 5篇包含大量公式和表格的论文

**配置**:
- GPU: 开启 ✅
- 模式: 高精度模式 🎯
- 批处理: 8
- 预估时间: ~15分钟

### 示例3: CPU环境处理

**场景**: 无GPU服务器，10个PDF文档

**配置**:
- GPU: 关闭 ❌
- 模式: 快速模式 ⚡
- 批处理: 4
- 预估时间: ~1小时

## 常见问题

### Q: 如何知道我有没有GPU?

**A**: 访问系统仪表板首页，查看"GPU状态"卡片。如果显示GPU型号和显存信息，说明GPU可用。

### Q: GPU模式处理失败怎么办?

**A**: 
1. 检查GPU状态是否正常
2. 尝试降低批处理大小
3. 如果问题持续，切换到CPU模式

### Q: 两种模式可以混用吗?

**A**: 可以！您可以为不同文件选择不同模式：
- 简单文档 → 快速模式
- 复杂文档 → 高精度模式

### Q: 批处理大小设置多少合适?

**A**: 
- **GPU模式**: 
  - 显存≥16GB: 可设置12-16
  - 显存8-16GB: 建议8-12
  - 显存<8GB: 建议4-8
- **CPU模式**: 建议2-4

### Q: 如何判断识别质量?

**A**: 处理完成后:
1. 查看生成的切片内容
2. 对比原文档检查关键内容
3. 特别注意公式、表格是否正确
4. 如果质量不满意，可尝试高精度模式

## 性能优化技巧

### 技巧1: 文档预处理

- 使用300+ DPI扫描
- 去除页面噪点
- 校正文档倾斜
- 增强对比度

### 技巧2: 合理分批处理

**大量文档**:
1. 按文档复杂度分组
2. 简单文档用快速模式批量处理
3. 复杂文档用高精度模式单独处理

### 技巧3: 错峰处理

**系统负载低时处理**:
- 夜间或周末
- GPU利用率<50%时
- 避免多人同时处理

### 技巧4: 监控GPU状态

**实时查看**:
1. 系统仪表板 → GPU状态
2. 查看显存使用率
3. 如果接近满载，降低批处理大小

## 界面位置

### OCR处理界面

```
项目详情页 → OCR处理标签
  ↓
选择MinerU引擎
  ↓
点击"显示高级选项"
  ↓
配置GPU和识别模式
```

### 系统设置界面

```
右上角设置图标 → OCR引擎配置
  ↓
找到MinerU引擎卡片
  ↓
点击"编辑"
  ↓
修改默认配置
```

## 故障排查

### 问题: GPU开关无效

**检查**:
```bash
# 检查GPU状态
docker exec cotstudio-mineru-1 nvidia-smi
```

**解决**: 如果报错，联系系统管理员检查GPU配置

### 问题: 处理速度很慢

**检查清单**:
- [ ] GPU是否开启
- [ ] 批处理大小是否合理
- [ ] 系统负载是否过高
- [ ] 文档是否过于复杂

**优化建议**:
1. 开启GPU加速
2. 使用快速模式
3. 适当增加批处理大小
4. 简化文档(如果可能)

### 问题: 识别精度不高

**检查清单**:
- [ ] 是否使用高精度模式
- [ ] 文档扫描质量如何
- [ ] 是否有特殊字符或公式

**提升方法**:
1. 切换到高精度模式
2. 提高扫描分辨率
3. 对关键页面单独处理
4. 必要时人工校对

## 最佳实践

### ✅ 推荐做法

1. **先测试后批量**: 用1-2个文件测试配置是否合适
2. **保存常用配置**: 在设置中保存您的偏好配置
3. **定期查看GPU**: 监控GPU使用情况，避免过载
4. **记录处理结果**: 记录不同配置的效果，优化选择

### ❌ 避免做法

1. **盲目开启高精度**: 简单文档不需要高精度模式
2. **批处理过大**: 可能导致显存溢出
3. **同时处理多文件**: 会降低每个任务的速度
4. **忽略错误信息**: 及时查看日志解决问题

## 版本信息

- **功能版本**: v1.0.0
- **实现日期**: 2025-10-16
- **MinerU版本**: 2.5.4
- **支持GPU**: NVIDIA CUDA 11.8+

## 更多帮助

- 📖 [详细实现文档](./MINERU_GPU_MODE_IMPLEMENTATION.md)
- 📖 [MinerU使用指南](./MINERU_OCR_USER_GUIDE.md)
- 📖 [故障排查报告](./OCR_MINERU_FIX_REPORT.md)

---

**需要帮助?** 查看系统日志或联系技术支持 🤝
